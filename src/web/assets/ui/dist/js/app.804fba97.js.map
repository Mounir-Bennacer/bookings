{"version":3,"sources":["webpack:///./src/models/ExRule.js","webpack:///./src/API.js","webpack:///./src/store/index.js","webpack:///./src/main.js","webpack:///./src/helpers/uuid.js","webpack:///./src/models/RecursionRule.js","webpack:///external \"Vue\"","webpack:///./src/enums/Frequency.js"],"names":["ExRule","_this","def","arguments","length","undefined","overwriteId","__WEBPACK_IMPORTED_MODULE_0__Users_tam_Sites_CRAFT_3_PLUGINS_bookings_resources_ui_node_modules_babel_runtime_helpers_classCallCheck___default","this","__WEBPACK_IMPORTED_MODULE_1__Users_tam_Sites_CRAFT_3_PLUGINS_bookings_resources_ui_node_modules_babel_runtime_helpers_possibleConstructorReturn___default","__proto__","Object","getPrototypeOf","call","defineProperty","__WEBPACK_IMPORTED_MODULE_3__Users_tam_Sites_CRAFT_3_PLUGINS_bookings_resources_ui_node_modules_babel_runtime_helpers_assertThisInitialized___default","configurable","enumerable","writable","value","keys","map","key","hasOwnProperty","Date","__WEBPACK_IMPORTED_MODULE_4__RecursionRule__","API","postActionRequest","_postActionRequest","asyncToGenerator_default","regeneratorRuntime","mark","_callee","action","data","url","opts","response","wrap","_context","prev","next","Craft","actionUrl","method","headers","Headers","Accept","body","JSON","stringify","credentials","fetch","sent","json","abrupt","stop","_x","_x2","apply","refreshCalendar","_callee6","commit","state","res","slots","_context6","baseRule","convertToRRuleObject","exceptions","values","r","reduce","slot","d","date","UTC","getFullYear","getMonth","getDate","getHours","getMinutes","day","getDay","hour","minute","year","month","getTime","all","push","duration","t0","console","error","external__Vue__default","a","use","vuex_esm","store_state","RecursionRule","exceptionsSort","computedSlots","slotDuration","getters","getExceptionById","id","actions","updateRule","_updateRule","_ref","payload","_x3","_x4","addException","_addException","_callee2","_ref2","_context2","_x5","updateExceptionsSort","_updateExceptionsSort","_callee3","_ref3","_context3","_x6","_x7","duplicateExceptionById","_duplicateExceptionById","_callee4","_ref4","_context4","_x8","_x9","deleteExceptionById","_deleteExceptionById","_callee5","_ref5","_context5","_x10","_x11","mutations","nextRule","constructor","newExRule","ex","nextExceptions","objectSpread_default","nextSort","toConsumableArray_default","splice","indexOf","refreshComputedSlots","_ref6","store","Store","debug","BookingsUI","section","options","onImport","App","vm","render","h","default","$mount","document","querySelector","appendChild","$el","__webpack_require__","e","then","bind","Error","concat","config","productionTip","portal_vue_default","window","__BookingsUI","uuidv4","replace","c","Math","random","v","toString","RecursionRule_RecursionRule","classCallCheck_default","Frequency","Hourly","setSeconds","setMilliseconds","_this2","obj","convertToDataObject","repeats","count","until","toUTCString","module","exports","Vue"],"mappings":"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","file":"js/app.804fba97.js","sourcesContent":["import RecursionRule from \"./RecursionRule\";\n\nexport default class ExRule extends RecursionRule {\n\n\t// Properties\n\t// =========================================================================\n\n\t// Properties: Instance\n\t// -------------------------------------------------------------------------\n\n\t/**\n\t * @type {boolean}\n\t */\n\tbookable = false;\n\n\t// Constructor\n\t// =========================================================================\n\n\tconstructor (def = {}, overwriteId = false) {\n\t\tsuper();\n\n\t\tObject.keys(def).map(key => {\n\t\t\tif (!this.hasOwnProperty(key))\n\t\t\t\treturn;\n\n\t\t\tif (key === \"id\" && overwriteId)\n\t\t\t\treturn;\n\n\t\t\tlet value = def[key];\n\n\t\t\tif (key in [\"start\", \"until\"])\n\t\t\t\tvalue = new Date(+value);\n\n\t\t\tthis[key] = value;\n\t\t});\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/models/ExRule.js","/* global Craft */\n\nexport default {\n\tasync postActionRequest (action, data) {\n\t\tconst url = typeof Craft !== \"undefined\"\n\t\t\t? Craft.actionUrl + \"/\"\n\t\t\t: \"https://dev.craft3/index.php?p=actions/\";\n\n\t\tconst opts = {\n\t\t\tmethod: \"POST\",\n\t\t\theaders: new Headers({\n\t\t\t\t\"Accept\": \"application/json\",\n\t\t\t}),\n\t\t\tbody: JSON.stringify(data),\n\t\t};\n\n\t\tif (typeof Craft !== \"undefined\")\n\t\t\topts.credentials = \"include\";\n\n\t\tconst response = await fetch(url + action, opts);\n\n\t\treturn await response.json();\n\t}\n};\n\n\n// WEBPACK FOOTER //\n// ./src/API.js","import Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport API from \"../API\";\nimport RecursionRule from \"../models/RecursionRule\";\nimport ExRule from \"../models/ExRule\";\n\nVue.use(Vuex);\n\n// API\n// =========================================================================\n\n/**\n * Refreshes the calendar data from the API\n *\n * @param commit\n * @param state\n * @return {Promise<void>}\n */\nasync function refreshCalendar (commit, state) {\n\t// TODO: Add validation to RRules when converting\n\t// (don't refresh if any rule is invalid)\n\n\tconst body = {\n\t\tbaseRule: state.baseRule.convertToRRuleObject(),\n\t\texceptions: Object.values(state.exceptions).map(r => r.convertToRRuleObject()),\n\t};\n\n\ttry {\n\t\tconst res = await API.postActionRequest(\"bookings/api/get-calendar\", body);\n\n\t\tconst slots = res.slots.reduce((slots, slot) => {\n\t\t\tconst d = new Date(slot.date);\n\n\t\t\t// Convert from UTC to local time\n\t\t\t// (dropping seconds & milliseconds, since we're not using them)\n\t\t\tslot.date = new Date(Date.UTC(\n\t\t\t\td.getFullYear(),\n\t\t\t\td.getMonth(),\n\t\t\t\td.getDate(),\n\t\t\t\td.getHours(),\n\t\t\t\td.getMinutes(),\n\t\t\t\t0,\n\t\t\t\t0\n\t\t\t));\n\n\t\t\tslot.day = slot.date.getDay();\n\t\t\tslot.hour = slot.date.getHours();\n\t\t\tslot.minute = slot.date.getMinutes();\n\n\t\t\tconst year = slot.date.getFullYear()\n\t\t\t\t, month = slot.date.getMonth() + 1\n\t\t\t\t, date = slot.date.getDate()\n\t\t\t\t, key = slot.date.getTime();\n\n\t\t\tif (!slots.hasOwnProperty(year))\n\t\t\t\tslots[year] = {};\n\n\t\t\tif (!slots[year].hasOwnProperty(month))\n\t\t\t\tslots[year][month] = { all: {} };\n\n\t\t\tif (!slots[year][month].hasOwnProperty(date))\n\t\t\t\tslots[year][month][date] = [];\n\n\t\t\tslots[year][month].all[key] = slot;\n\t\t\tslots[year][month][date].push(key);\n\n\t\t\treturn slots;\n\t\t}, {});\n\n\t\tcommit(\"refreshComputedSlots\", { slots, duration: res.duration });\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n}\n\n// State\n// =========================================================================\n\nconst state = {\n\tbaseRule: new RecursionRule(),\n\texceptions: {},\n\texceptionsSort: [],\n\n\tcomputedSlots: {},\n\tslotDuration: 1,\n};\n\nconst getters = {\n\tgetExceptionById: (state) => (id) => {\n\t\treturn state.exceptions[id];\n\t},\n};\n\nconst actions = {\n\n\tasync updateRule ({ commit, state }, payload) {\n\t\tcommit(\"updateRule\", payload);\n\t\tawait refreshCalendar(commit, state);\n\t},\n\n\tasync addException ({ commit, state }) {\n\t\tcommit(\"addException\");\n\t\tawait refreshCalendar(commit, state);\n\t},\n\n\tasync updateExceptionsSort ({ commit, state }, payload) {\n\t\tcommit(\"updateExceptionsSort\",  payload);\n\t\tawait refreshCalendar(commit, state);\n\t},\n\n\tasync duplicateExceptionById ({ commit, state }, payload) {\n\t\tcommit(\"duplicateExceptionById\", payload);\n\t\tawait refreshCalendar(commit, state);\n\t},\n\n\tasync deleteExceptionById ({ commit, state }, payload) {\n\t\tcommit(\"deleteExceptionById\", payload);\n\t\tawait refreshCalendar(commit, state);\n\t}\n\n};\n\nconst mutations = {\n\n\t/**\n\t * Updates the given rule\n\t *\n\t * @param state\n\t * @param {RecursionRule|ExRule} nextRule\n\t */\n\tupdateRule (state, nextRule) {\n\t\tif (nextRule.constructor === RecursionRule) {\n\t\t\tstate.baseRule = nextRule;\n\t\t\treturn;\n\t\t}\n\n\t\tstate.exceptions[nextRule.id] = nextRule;\n\t},\n\n\t/**\n\t * Creates a new exception and adds it to the bottom of the list\n\t *\n\t * @param state\n\t */\n\taddException (state) {\n\t\tconst newExRule = new ExRule();\n\t\tstate.exceptions[newExRule.id] = newExRule;\n\t\tstate.exceptionsSort.push(newExRule.id);\n\t},\n\n\t/**\n\t * Updates the order of the exceptions\n\t *\n\t * @param state\n\t * @param exceptionsSort\n\t */\n\tupdateExceptionsSort (state, exceptionsSort) {\n\t\tstate.exceptionsSort = exceptionsSort;\n\t},\n\n\t/**\n\t * Duplicates the exception (by the given ID) appends it to the list\n\t *\n\t * @param state\n\t * @param id\n\t */\n\tduplicateExceptionById (state, id) {\n\t\tconst ex = state.exceptions[id];\n\t\tconst next = new ExRule(ex, true);\n\n\t\tstate.exceptions[next.id] = next;\n\t\tstate.exceptionsSort.push(next.id);\n\t},\n\n\t/**\n\t * Deletes the exception for the given ID\n\t *\n\t * @param state\n\t * @param id\n\t */\n\tdeleteExceptionById (state, id) {\n\t\tconst nextExceptions = { ...state.exceptions }\n\t\t\t, nextSort = [ ...state.exceptionsSort ];\n\n\t\tdelete nextExceptions[id];\n\t\tnextSort.splice(nextSort.indexOf(id), 1);\n\n\t\tstate.exceptions = nextExceptions;\n\t\tstate.exceptionsSort = nextSort;\n\t},\n\n\t/**\n\t * Sets the computed slots\n\t *\n\t * @param state\n\t * @param slots\n\t */\n\trefreshComputedSlots (state, { slots, duration }) {\n\t\tstate.computedSlots = slots;\n\t\tstate.slotDuration = duration;\n\t},\n};\n\nexport default new Vuex.Store({\n\tstate,\n\tgetters,\n\tactions,\n\tmutations,\n\tdebug: process.env.NODE_ENV !== \"production\",\n});\n\n\n// WEBPACK FOOTER //\n// ./src/store/index.js","import \"whatwg-fetch\";\nimport Vue from \"vue\";\nimport PortalVue from \"portal-vue\";\nimport store from \"./store\";\n\nVue.config.productionTip = false;\nVue.use(PortalVue);\n\n/**\n * ```js\n * new window.__BookingsUI(\"field\", \"#namespacedId\", {});\n * ```\n *\n * @param {string} section\n * @param {string=} id\n * @param {Object=} options\n * @constructor\n */\nfunction BookingsUI (section, id = \"#app\", options = null) {\n\n\tconst onImport = App => {\n\t\tconst vm = new Vue({\n\t\t\trender: h => h(App.default),\n\t\t\tdata: { options },\n\t\t\tstore,\n\t\t}).$mount();\n\n\t\t// Mount as a child of the parent (not replacing it)\n\t\tdocument.querySelector(id).appendChild(vm.$el);\n\t};\n\n\tswitch (section) {\n\t\tcase \"dev\":\n\t\tcase \"field\":\n\t\t\timport(\"./Field/index.vue\").then(onImport);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthrow new Error(`Unknown Bookings UI section: ${section}`);\n\t}\n\n}\n\nif (process.env.NODE_ENV === \"development\")\n\tnew BookingsUI(\"dev\");\n\nwindow.__BookingsUI = BookingsUI;\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","export default function uuidv4() {\n\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n\t\tconst r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\n\t\treturn v.toString(16);\n\t});\n}\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/uuid.js","import Frequency from \"../enums/Frequency\";\nimport uuid from \"../helpers/uuid\";\n\nexport default class RecursionRule {\n\n\t// Properties\n\t// =========================================================================\n\n\t// Properties: Instance\n\t// -------------------------------------------------------------------------\n\n\t/**\n\t * @type {String|null}\n\t */\n\tid = null;\n\n\t/**\n\t * @type {String}\n\t */\n\tfrequency = Frequency.Hourly;\n\n\t/**\n\t * @type {Date}\n\t */\n\tstart = new Date();\n\n\t/**\n\t * @type {number}\n\t */\n\tduration = 1;\n\n\t/**\n\t * @type {Number}\n\t */\n\tinterval = 0;\n\n\t/**\n\t * @type {String}\n\t */\n\trepeats = \"count\";\n\n\t/**\n\t * @type {Number|null}\n\t */\n\tcount = 1;\n\n\t/**\n\t * @type {Date|null}\n\t */\n\tuntil = new Date();\n\n\t/**\n\t * @type {Number[]|null}\n\t */\n\tbyMonth = [];\n\n\t/**\n\t * @type {Number[]|null}\n\t */\n\tbyWeekNumber = [];\n\n\t/**\n\t * @type {Number[]|null}\n\t */\n\tbyYearDay = [];\n\n\t/**\n\t * @type {Number[]|null}\n\t */\n\tbyMonthDay = [];\n\n\t/**\n\t * @type {String[]|null}\n\t */\n\tbyDay = [];\n\n\t/**\n\t * @type {Number[]|null}\n\t */\n\tbyHour = [];\n\n\t/**\n\t * @type {Number[]|null}\n\t */\n\tbyMinute = [];\n\n\t/**\n\t * @type {Number[]|null}\n\t */\n\tbySetPosition = [];\n\n\t// Constructor\n\t// =========================================================================\n\n\tconstructor (def = {}, overwriteId = false) {\n\t\tthis.id = uuid();\n\n\t\tObject.keys(def).map(key => {\n\t\t\tif (!this.hasOwnProperty(key))\n\t\t\t\treturn;\n\n\t\t\tif (key === \"id\" && overwriteId)\n\t\t\t\treturn;\n\n\t\t\tlet value = def[key];\n\n\t\t\tif (key in [\"start\", \"until\"]) {\n\t\t\t\tvalue = new Date(+value);\n\t\t\t\tvalue.setSeconds(0);\n\t\t\t\tvalue.setMilliseconds(0);\n\t\t\t}\n\n\t\t\tthis[key] = value;\n\t\t});\n\t}\n\n\t// Helpers\n\t// =========================================================================\n\n\t/**\n\t * Returns the class as a plain JS object ready of Vue's data()\n\t *\n\t * @return {{}}\n\t */\n\tconvertToDataObject () {\n\t\treturn Object.keys(this).reduce((obj, key) => {\n\t\t\tif (key !== \"id\")\n\t\t\t\tobj[key] = this[key];\n\n\t\t\tif (obj[key] instanceof Date) {\n\t\t\t\tobj[key].setSeconds(0);\n\t\t\t\tobj[key].setMilliseconds(0);\n\t\t\t}\n\n\t\t\treturn obj;\n\t\t}, {});\n\t}\n\n\t/**\n\t * Converts the class to a plain JS object ready for sending to the server\n\t *\n\t * @return {{}}\n\t */\n\tconvertToRRuleObject () {\n\t\tconst data = this.convertToDataObject();\n\n\t\tswitch (data.repeats) {\n\t\t\tcase \"until\":\n\t\t\t\tdelete data.count;\n\t\t\t\tbreak;\n\t\t\tcase \"count\":\n\t\t\t\tdelete data.until;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdelete data.count;\n\t\t\t\tdelete data.until;\n\t\t}\n\n\t\t// Ensure dates are UTC strings\n\t\tfor (let key in data) {\n\t\t\tconst value = data[key];\n\n\t\t\tif (!(value instanceof Date))\n\t\t\t\tcontinue;\n\n\t\t\tdata[key] = value.toUTCString();\n\t\t}\n\n\t\treturn data;\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/models/RecursionRule.js","module.exports = Vue;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Vue\"\n// module id = lRwf\n// module chunks = 1","export default class Frequency {\n\n\t// Properties\n\t// =========================================================================\n\n\t// Properties: Static\n\t// -------------------------------------------------------------------------\n\n\tstatic Yearly = \"YEARLY\";\n\tstatic Monthly = \"MONTHLY\";\n\tstatic Weekly = \"WEEKLY\";\n\tstatic Daily = \"DAILY\";\n\tstatic Hourly = \"HOURLY\";\n\tstatic Minutely = \"MINUTELY\";\n\n\t// Functions\n\t// =========================================================================\n\n\t/**\n\t * @return {{key: string, value: *}[]}\n\t */\n\tstatic asKeyValueArray () {\n\t\treturn Object.keys(this).map(key => ({ key, value: this[key] }));\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/enums/Frequency.js"],"sourceRoot":""}